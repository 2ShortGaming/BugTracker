@using BugTracker.Models
@using BugTracker.Helpers
@model IEnumerable<Project>
@{
    var projectHelper = new ProjectHelper();
    var roleHelper = new RolesHelper();
    var userHelper = new UserHelper();
    
}
    <style>
        #UserIds {
            min-height: 200px;
        }
    </style>


@if (User.IsInRole("Admin") || User.IsInRole("Project Manager"))
{
    <p>
        @Html.ActionLink("Create New", "Create")
    </p>
}
@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    <br />
    <br />
    <br />
    <br />
    <h2>Manage Projects</h2>
<div class="row">
    <div class="col-md-2 col-md-offset-3">
        <div class="form-group">
            @Html.Label("UserIds", "Users", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-12" style="color:snow">
                @Html.ListBox("UserIds", null, htmlAttributes: new { @class = "form-control" })
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-2">
        <div class="form-group">
            @Html.Label("Projects", null, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-12" style="color:snow">
                @Html.DropDownList("RoleName", null, "--Remove From Project--", htmlAttributes: new { @class = "form-control" })
            </div>
        </div>
        @Html.DropDownList("Add to Project", "--Remove From Project--")
    </div>

</div>
<div class="row">
    <div class="col-md-offset-3 col-md-4">
        <button type="submit" class="btn btn-danger">Manage Project Assignment(s)</button>
    </div>
</div>
}

<table id="table" class="table">
    <thead>
    <tr>
        <th>
            @Html.DisplayName("Project Name")
        </th>
        <th>
            @Html.DisplayName("Participants")
        </th>
    </tr>
    </thead>

    <tbody>
    @foreach (var project in Model)
    {
        <tr>
            <td>
                @Html.Display(project.Name)
            </td>
            <td>
                @foreach (var user in projectHelper.ListUsersOnProject(project.Id))
                {
                    @user.FullName <br />
                }
            </td>
        </tr>
    }

    </tbody>

</table>

