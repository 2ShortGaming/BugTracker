@using BugTracker.Models
@using BugTracker.Helpers
@model IEnumerable<Project>
@{
    var projectHelper = new ProjectHelper();
    var roleHelper = new RolesHelper();
    var userHelper = new UserHelper();

}
<style>
    #UserIds {
        min-height: 200px;
    }
</style>


@if (User.IsInRole("Admin") || User.IsInRole("Project Manager"))
{
    <br />
    <br />

    <button class="btn btn-primary">
        @Html.ActionLink("+Create New Project", "ProjectWizard")
    </button>

    
}


<br />
<br />
<h2 class="col-6 offset-3">Manage Projects</h2>
<br />
<br />

@using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()

        @*<div class="row">
            <div class="col-md-9 col-md-offset-3">
                <div class="form-group">
                    @/*Html.Label("UserIds", "Users", htmlAttributes: new { @class = "control-label col-md-12" })*/
                    <div class="col-md-12" style="color:snow">
                        @/*Html.ListBox("UserIds", null, htmlAttributes: new { @class = "form-control" })*/
                    </div>
                </div>
            </div>
        </div>
<div class="row">
        <div class="col-md-8">
            <div class="form-group">
                @/*Html.Label("ProjectIds", "Projects", htmlAttributes: new { @class = "control-label col-md-12" })*/
                <div class="col-md-12" style="color:snow">
                    @/*Html.DropDownList("ProjectIds", null, "--Remove From Project--", htmlAttributes: new { @class = "form-control" })*/
                </div>
            </div>
            @Html.DropDownList("Add to Project", "--Remove From Project--")
        </div>

    </div>*@
@*<div class="row">
            <div class="col-md-offset-3 col-md-4">
                <button type="submit" class="btn btn-danger">Manage Project Assignment(s)</button>
            </div>
        </div>*@
    }

<table class="table table-light table-borderless col-12">
    <thead>
        <tr>
            <th>
                @Html.DisplayName("Project Name")
            </th>
            <th>
                @Html.DisplayName("Participants")
            </th>
        </tr>
    </thead>

    <tbody>
        @foreach (var project in Model)
        {
            <tr>
                <td style="background-color:chocolate">
                    @project.Name
                </td>
                <td style="background-color:chocolate">
                    @foreach (var user in projectHelper.ListUsersOnProject(project.Id))
                    {
                        @user.FullName <br />
                    }
                </td>
                <td style="background-color:chocolate">
                    @Html.ActionLink("Edit", "Edit", new { id = project.Id }) |
                    @Html.ActionLink("Details", "Details", new { id = project.Id }) |
                    @Html.ActionLink("Delete", "Delete", new { id = project.Id })
                </td>
            </tr>
        }

    </tbody>

</table>

